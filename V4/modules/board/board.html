<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ORB Board - Éditeur Tactique</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="manager.css">
    <link rel="stylesheet" href="board.css">
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>.hidden { display: none !important; }</style>
</head>
<body class="view-full-court">

    <header class="app-header">
        <div class="header-content">
            <div class="header-left">
                <button id="toggle-playbook-manager-btn" title="Gérer le Playbook">
                    <svg viewBox="0 0 24 24"><path d="M19 2H5C3.9 2 3 2.9 3 4V20C3 21.1 3.9 22 5 22H19C20.1 22 21 21.1 21 20V4C21 2.9 20.1 2 19 2M17 18H7V16H17V18M17 14H7V12H17V14M17 10H7V8H17V10Z"/></svg>
                    <span>Playbook</span>
                </button>
            </div>
            <div class="header-center">
                <h1>ORB <span class="highlight">TACTICAL BOARD</span></h1>
            </div>
            <div class="header-right">
                <button id="show-library-btn" class="btn-icon" title="Bibliothèque de Playbooks">
                    <svg viewBox="0 0 24 24"><path d="M4 6H2V20C2 21.1 2.9 22 4 22H18V20H4V6M20 2H8C6.9 2 6 2.9 6 4V16C6 17.1 6.9 18 8 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M18 10H15V13H13V10H10V8H13V5H15V8H18V10Z"/></svg>
                </button>
                <button id="toggle-settings-btn" class="btn-icon" title="Paramètres">
                    <svg viewBox="0 0 24 24"><path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" /></svg>
                </button>
            </div>
        </div>
    </header>

    <div id="play-manager-container" class="floating-panel hidden">
        <div id="play-manager">
            <div class="playbook-group">
                <label for="play-name-input">Nom du Playbook</label>
                <input type="text" id="play-name-input" placeholder="Entrez un nom...">
            </div>
            <div class="playbook-group">
                <label>Fichier Local</label>
                <div class="button-row">
                    <input type="file" id="import-file-input" class="hidden" accept=".json,application/json">
                    <button id="load-file-btn" title="Charger un playbook"><svg viewBox="0 0 24 24"><path d="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z" /></svg> Charger</button>
                    <button id="save-file-btn" title="Sauvegarder le playbook"> <svg viewBox="0 0 24 24"><path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z" /></svg> Exporter</button>
                </div>
            </div>
            <div class="playbook-group">
                <label>Bibliothèque Interne</label>
                <div class="button-row">
                    <button id="save-to-library-btn" class="btn-primary" style="width: 100%;">
                        <svg viewBox="0 0 24 24"><path d="M17 3H7C5.9 3 5 3.9 5 5V19C5 20.1 5.9 21 7 21H17C18.1 21 19 20.1 19 19V5C19 3.9 18.1 3 17 3M17 19H7V5H17V19M12 9L10 11H13V15H11V13L9 15L11 17V15H15V11H13L15 9H12Z"/></svg>
                        Sauvegarder
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="settings-panel" class="floating-panel hidden">
        <div class="playbook-group">
            <label>Paramètres Généraux</label>
            <div class="settings-row">
                <span>Mode sombre</span>
                <button id="theme-toggle-btn">Changer</button>
            </div>
            <div class="settings-row" style="margin-top: 10px;">
                <span>Thème Équipe (Crab)</span>
                <button id="team-theme-btn">Activer</button>
            </div>
            <div class="settings-row" style="margin-top: 10px;">
                <span>Mode de Tracé</span>
                <button id="input-mode-btn">Stylet/Souris</button>
            </div>
        </div>
    </div>

    <div class="main-content">
        <aside id="sidebar">
            <div id="properties-panel" class="section-container">
                <h2>Propriétés</h2>
                <div id="prop-content">
                    <div id="player-props" class="prop-group hidden">
                        <div class="prop-row"><label>Couleur :</label><input type="color" id="player-color-input"></div>
                    </div>
                    <div id="path-props" class="prop-group hidden">
                        <div class="prop-row"><label>Couleur :</label><input type="color" id="path-color-input"></div>
                    </div>
                    <p id="no-props-message">Sélectionnez un élément.</p>
                </div>
            </div>
            
            <div class="section-container">
                <h2>Séquence</h2>
                <div id="scene-controls">
                    <button id="add-scene-btn">Dupliquer</button>
                    <button id="animate-scene-btn">Animer</button>
                    <button id="play-animation-btn" title="Play">▶</button>
                    <button id="delete-scene-btn" class="danger">X</button>
                </div>
                <ul id="scene-list"></ul>
            </div>
        </aside>

        <main class="main-area">
            <div class="section-container" style="padding: 10px; margin-bottom: 15px;">
                <div id="toolbar">
                     <div class="tool-group">
                        <button id="tool-select" class="tool-btn active" title="Sélectionner"><svg viewBox="0 0 24 24"><path d="M13.62,19.33L12.1,22.45L10.59,19.33L7.47,17.82L10.59,16.3L12.1,13.18L13.62,16.3L16.74,17.82L13.62,19.33M5.5,3L4,6.5L7.5,8L4,9.5L5.5,13L9,11.5L12.5,13L11,9.5L14.5,8L11,6.5L9,3L5.5,3Z" /></svg></button>
                        <button id="tool-player" class="tool-btn" title="Attaquant"><svg viewBox="0 0 24 24"><path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" /></svg></button>
                        <button id="tool-defender" class="tool-btn" title="Défenseur"><svg viewBox="0 0 24 24"><path d="M12,1.75A6.25,6.25 0 0,0 5.75,8C5.75,10.87 7.91,13.28 10.7,13.84V16.2L7.2,17.6C6.7,17.8 6.5,18.4 6.7,18.9L7.6,20.8C7.8,21.3 8.4,21.5 8.9,21.3L12,20L15.1,21.3C15.6,21.5 16.2,21.3 16.4,20.8L17.3,18.9C17.5,18.4 17.3,17.8 16.8,17.6L13.3,16.2V13.84C16.09,13.28 18.25,10.87 18.25,8A6.25,6.25 0 0,0 12,1.75Z"/></svg></button>
                        <button id="tool-ball" class="tool-btn" title="Ballon"><svg viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M4.3,15.24L9.5,13.2L11,18.05L5.82,20.07C4.94,18.6 4.3,16.97 4.3,15.24M18.18,20.07L13,18.05L14.5,13.2L19.7,15.24C19.7,16.97 19.06,18.6 18.18,20.07M19.93,8.93L15.5,10.8L14.1,5.5C15.86,5.88 17.39,6.94 18.5,8.32C19.03,8.44 19.5,8.65 19.93,8.93M9.9,5.5L8.5,10.8L4.07,8.93C4.5,8.65 4.97,8.44 5.5,8.32C6.61,6.94 8.14,5.88 9.9,5.5M12,6.34C10.73,7.3 10.2,8.89 10.5,10.3L12,15L13.5,10.3C13.8,8.89 13.27,7.3 12,6.34Z" /></svg></button>
                    </div>
                    <div class="tool-group">
                        <button id="tool-arrow" class="tool-btn" title="Course"><svg viewBox="0 0 24 24"><path d="M4 12L20 12L16 8M20 12L16 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg></button>
                        <button id="tool-pass" class="tool-btn" title="Passe"><svg viewBox="0 0 24 24"><path d="M4 12L20 12L16 8M20 12L16 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke-dasharray="4 4"/></svg></button>
                        <button id="tool-dribble" class="tool-btn" title="Dribble"><svg viewBox="0 0 24 24"><path d="M4 18 Q 8 13, 12 18 T 20 18 M17 15l4-3l-4-3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg></button>
                    </div>
                    <div class="tool-group">
                        <button id="action-undo" class="tool-btn" title="Annuler">↩</button>
                        <button id="action-redo" class="tool-btn" title="Rétablir">↪</button>
                        <button id="tool-clear" class="tool-btn danger" title="Effacer">X</button>
                    </div>
                </div>
            </div>

            <div id="court-container">
                <div id="court-background-container">
                    <svg id="court-svg" class="court" viewBox="0 0 280 150" preserveAspectRatio="none">
                        <rect x="0" y="0" width="280" height="150" fill="#BFA98D"/>
                        <g stroke="#212121" stroke-width="0.6" fill="none">
                            <rect x="0" y="0" width="280" height="150"/><line x1="140" y1="0" x2="140" y2="150"/>
                            <rect x="0" y="50.5" width="58" height="49" /><path d="M 58 50.5 A 18 18 0 0 1 58 99.5" />
                            <path d="M 0 6 L 29.1 6 A 67.5 67.5 0 0 1 29.1 144 L 0 144" />
                            <rect x="222" y="50.5" width="58" height="49" /><path d="M 222 50.5 A 18 18 0 0 0 222 99.5" />
                            <path d="M 280 6 L 250.9 6 A 67.5 67.5 0 0 0 250.9 144 L 280 144" />
                        </g>
                    </svg>
                </div>
                <canvas id="basketball-court"></canvas>
            </div>
        </main>
    </div>

    <div id="animation-player" class="hidden">
        <div id="animation-container">
            <div id="animation-court-background"></div>
            <canvas id="animation-canvas"></canvas>
        </div>
        <div id="animation-controls">
            <button id="anim-play-pause-btn">▶</button>
            <button id="anim-close-btn">X</button>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script src="db.js"></script>
    <script src="state.js"></script>
    <script src="utils.js"></script>
    <script src="manager.js"></script>
    <script src="renderer.js"></script>
    <script src="interaction.js"></script>
    <script src="animation.js"></script>
    <script src="ui.js"></script>
    <script src="board.js"></script>

</body>
</html>